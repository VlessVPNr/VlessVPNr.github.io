<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2563eb">
    <title>VPN –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</title>
    <style>
        /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ, –Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º: */
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }
        
        .countdown {
            font-size: 3em;
            font-weight: bold;
            color: #2563eb;
            margin: 20px 0;
            text-align: center;
        }
        
        .auto-redirect {
            text-align: center;
            padding: 15px;
            background: #f0f9ff;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #bae6fd;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <span class="logo-icon">üîí</span>
                VLESS VPN
            </div>
            <h1 class="title">–í–∞—à–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞</h1>
            <p class="subtitle">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ VPN</p>
            <div id="status" class="status status-active">‚úÖ –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞</div>
        </div>
        
        <div class="config-section">
            <div class="config-info">
                <h3>üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</h3>
                
                <div class="config-item">
                    <span class="config-label">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</span>
                    <span id="deviceName" class="config-value">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                
                <div class="config-item">
                    <span class="config-label">–¢–∏–ø VPN:</span>
                    <span id="vpnType" class="config-value">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                
                <div class="config-item">
                    <span class="config-label">–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ:</span>
                    <span id="expiryDate" class="config-value">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                
                <div class="config-item">
                    <span class="config-label">–°–µ—Ä–≤–µ—Ä:</span>
                    <span id="server" class="config-value">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
            </div>
            
            <!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç -->
            <div class="auto-redirect" id="autoRedirect">
                <p>üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ <b id="countdown">5</b> —Å–µ–∫—É–Ω–¥...</p>
            </div>
            
            <div class="buttons">
                <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä—è–º–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ Happ -->
                <a id="happDirectLink" class="btn btn-success" href="#" target="_blank">
                    <span class="btn-icon">üöÄ</span>
                    –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ–π—á–∞—Å (Happ VPN)
                </a>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –≤–µ–±-–≤–µ—Ä—Å–∏–∏ happ.tools -->
                <a id="happWebLink" class="btn btn-primary" href="#" target="_blank">
                    <span class="btn-icon">üåê</span>
                    –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ happ.tools
                </a>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è -->
                <button onclick="copyConfig()" class="btn btn-secondary">
                    <span class="btn-icon">üìã</span>
                    –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
                </button>
                
                <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è QR –∫–æ–¥–∞ -->
                <button onclick="showQR()" class="btn btn-warning">
                    <span class="btn-icon">üì±</span>
                    –ü–æ–∫–∞–∑–∞—Ç—å QR-–∫–æ–¥
                </button>
            </div>
            
            <!-- QR –∫–æ–¥ (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
            <div class="qr-section" id="qrSection" style="display: none;">
                <h3>üì± QR-–∫–æ–¥ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <p>–û—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∫–∞–º–µ—Ä–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω–∞</p>
                <div class="qr-code">
                    <img id="qrCode" src="" alt="QR Code">
                </div>
                <button onclick="copyConfig()" class="copy-btn">
                    <span>üìã</span> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É
                </button>
            </div>
            
            <div class="instructions">
                <h3><span>üìã</span> –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ</h3>
                <ol>
                    <li>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç VPN —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥</li>
                    <li>–ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ–π—á–∞—Å"</li>
                    <li>–ò–ª–∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR-–∫–æ–¥ –∫–∞–º–µ—Ä–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω–∞</li>
                    <li>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Happ VPN –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å –≥–æ—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</li>
                    <li>–ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è" –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</li>
                </ol>
                <p><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –ï—Å–ª–∏ Happ VPN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —Å–∫–∞—á–∞–π—Ç–µ –µ–≥–æ –∏–∑ <a href="https://play.google.com/store/apps/details?id=com.happ.v2ray" target="_blank">Google Play</a> –∏–ª–∏ <a href="https://apps.apple.com/app/happ-vpn/id6476628951" target="_blank">App Store</a>.</p>
            </div>
        </div>
        
        <div class="footer">
            <p>¬© 2024 VLESS VPN. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            <p>–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞: <span id="generatedDate"></span></p>
            <p>ID: <span id="configId"></span></p>
        </div>
    </div>
    
    <div id="successMessage" class="success-message">
        ‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!
    </div>
    
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...</p>
    </div>

    <script>
        // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        let redirectTimer;
        let countdownValue = 5;
        
        document.addEventListener('DOMContentLoaded', function() {
            // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            const uuid = urlParams.get('uuid');
            const server = urlParams.get('server');
            const port = urlParams.get('port');
            const type = urlParams.get('type') || 'tcp';
            const path = urlParams.get('path') || '/';
            const host = urlParams.get('host') || server;
            const remark = decodeURIComponent(urlParams.get('remark') || 'VLESS VPN');
            const expiry = urlParams.get('expiry') || '2024-12-31';
            
            // –§–æ—Ä–º–∏—Ä—É–µ–º VLESS —Å—Å—ã–ª–∫—É
            let vlessLink;
            if (type === 'tcp') {
                // –î–ª—è Reality VPN
                vlessLink = `vless://${uuid}@${server}:${port}?` +
                           `type=tcp&security=reality&encryption=none&` +
                           `pbk=${urlParams.get('pbk') || ''}&fp=chrome&` +
                           `sni=${host}&sid=${urlParams.get('sid') || ''}&` +
                           `flow=xtls-rprx-vision` +
                           `#${encodeURIComponent(remark)}`;
            } else {
                // –î–ª—è WS
                vlessLink = `vless://${uuid}@${server}:${port}?` +
                           `type=ws&security=none&encryption=none&` +
                           `path=${encodeURIComponent(path)}&host=${host}` +
                           `#${encodeURIComponent(remark)}`;
            }
            
            // –ö–æ–¥–∏—Ä—É–µ–º –¥–ª—è URL
            const encodedVless = encodeURIComponent(vlessLink);
            
            // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫–∏
            const happDirectLink = `happ://add/${encodedVless}`;
            const happWebLink = `https://happ.tools/import?config=${encodedVless}`;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.getElementById('deviceName').textContent = remark;
            document.getElementById('vpnType').textContent = type === 'tcp' ? 'üåç –ó–∞—Ä—É–±–µ–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã' : 'üìú –ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏';
            document.getElementById('expiryDate').textContent = formatDate(expiry);
            document.getElementById('server').textContent = server.includes('193.39') ? 'üá≥üá± –ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã' : 'üåê VPN –°–µ—Ä–≤–µ—Ä';
            document.getElementById('happDirectLink').href = happDirectLink;
            document.getElementById('happWebLink').href = happWebLink;
            document.getElementById('generatedDate').textContent = new Date().toLocaleDateString('ru-RU');
            document.getElementById('configId').textContent = uuid ? uuid.substring(0, 8) : 'N/A';
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º QR –∫–æ–¥
            generateQRCode(vlessLink);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            window.vlessLink = vlessLink;
            window.happDirectLink = happDirectLink;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
            startAutoRedirect();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.getElementById('loading').style.display = 'none';
            document.querySelector('.container').style.display = 'block';
        });
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ Happ
        function startAutoRedirect() {
            redirectTimer = setInterval(function() {
                countdownValue--;
                document.getElementById('countdown').textContent = countdownValue;
                
                if (countdownValue <= 0) {
                    clearInterval(redirectTimer);
                    redirectToHapp();
                }
            }, 1000);
        }
        
        // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Happ
        function redirectToHapp() {
            // –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å happ:// —Å—Å—ã–ª–∫—É
            window.location.href = window.happDirectLink;
            
            // –ï—Å–ª–∏ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤–µ–±-–≤–µ—Ä—Å–∏—é
            setTimeout(function() {
                if (!document.hidden) {
                    window.location.href = window.happWebLink;
                }
            }, 1000);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å QR –∫–æ–¥
        function showQR() {
            const qrSection = document.getElementById('qrSection');
            qrSection.style.display = qrSection.style.display === 'none' ? 'block' : 'none';
        }
        
        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (formatDate, copyConfig, showSuccessMessage, generateQRCode) 
        // –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ –∫–∞–∫ –≤ –≤–∞—à–µ–º –∫–æ–¥–µ
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ru-RU', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        }
        
        function copyConfig() {
            navigator.clipboard.writeText(window.vlessLink).then(function() {
                showSuccessMessage('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            }).catch(function(err) {
                console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err);
                const textArea = document.createElement('textarea');
                textArea.value = window.vlessLink;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showSuccessMessage('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
            });
        }
        
        function showSuccessMessage(message) {
            const successMsg = document.getElementById('successMessage');
            successMsg.textContent = message;
            successMsg.style.display = 'block';
            
            setTimeout(function() {
                successMsg.style.display = 'none';
            }, 3000);
        }
        
        function generateQRCode(text) {
            const qrCodeElement = document.getElementById('qrCode');
            const qrCodeUrl = `https://chart.googleapis.com/chart?chs=250x250&cht=qr&chl=${encodeURIComponent(text)}&choe=UTF-8`;
            qrCodeElement.src = qrCodeUrl;
            qrCodeElement.alt = 'QR Code –¥–ª—è VPN –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏';
        }
    </script>
</body>
</html>
